
# 操作説明(オンラインマニュアル)

- ここには『将棋神やねうら王』の全般的な操作説明について書いてあります。
  - Update2まで適用してあるものとして説明が書かれています。(まだ適用していない方は是非アップデートしてください。)

- アップデート関連の情報、サウンドが再生されない、CPU負荷が高すぎる/低すぎるなどについては、[よくある質問](faq.md)をご覧ください。
- 今後のアップデートの予定など、作業進捗については、[WIP](WIP.md)をご覧ください。
- デバッグ機能の使い方などは、[開発者向け機能](dev_manual.md)をご覧ください。
- バグ、要望等は、こちらの記事にどうぞ。→ [『将棋神やねうら王』Update3までの遊戯施設 / やねうら王ブログ](http://yaneuraou.yaneu.com/2018/10/06/%E3%80%8E%E5%B0%86%E6%A3%8B%E7%A5%9E%E3%82%84%E3%81%AD%E3%81%86%E3%82%89%E7%8E%8B%E3%80%8Fupdate3%E3%81%BE%E3%81%A7%E3%81%AE%E9%81%8A%E6%88%AF%E6%96%BD%E8%A8%AD/)


## 通常対局の仕方


- メニューの「対局」→「通常対局」を選ぶと対局設定ダイアログが出てきます。
- そのあと、先手と後手について、「人間」であるか「コンピューター」であるかを選びます。「コンピューター」を選んだときは思考エンジンの選択画面になります。
- 棋力は思考エンジンに備わっているプリセットのなかから選べます。(「10級」～「九段」、「将棋神」、「カスタム」など)
- 「対局開始」ボタンをクリックすると対局開始になります。

- Q) 「九段」と「将棋神」とではどちらが強いですか？
  - A) 「九段」は九段ぐらいの強さになるように棋力を(弱く)調整したものです。
  「将棋神」のほうは、(弱く)調整されるということはなく、対局時間設定とお使いのPCの性能に依存した強さになります。

- Q) 「十段」「十一段」「十二段」は、架空の段位で強さがいまひとつピンときません。
  - A) 当初、「十段」ではなく名前をつけようという提案がマイナビの担当者からあったのですが、コンピューター将棋は今後もますます強くなるため、
  　下手に段位に名前をつけるとあとあと分かりづらくなるため、ストレートに「十段」のように数字で段位を表記することとなりました。
  　この段位、一段上がると前の段に対して勝率は76%程度です。レーティングで言うと+R200。
    (「九段」と「十段」が戦うと「十段」側の勝率は76%程度の意味。「十段」と「十一段」も同様。「十一段」と「十二段」も同様)
    なので、段位に関してはそのように理解していただければと…。

- Q) 「十級」でも結構、強いのですが。
  - A) 級位表記、将棋倶楽部24基準に調整してあるのですが、将棋倶楽部24では、一級と二級の差がレーティングでR100しか離れておらず、一級と十級でもR900の差でしかありません。
  　(段はR200ずつ離れています)　そのため、世間で言う十級とは少し違うかも知れません。
    (10級に歯が立たないという方には、駒落ち対局がお勧めです)
    (V1.23以降)1級～10級を下方修正しました。新1級 = 旧2級、新10級 = 旧20級相当です。

- Q) エンジンの詳細設定の各オプションを元の値に戻したい。
  - A) マウスをオプション項目のところにホバーさせるとtooltip(説明)が出ます。その一番下に元の値が「デフォルト値 = XXX」という形で表示されています。
  - すべてのエンジンオプションの初期化を行うには、次の機能でできます。
    (V1.13～V1.24) メニューの「ファイル」→「設定の初期化」→「各エンジン設定の初期化」
    (V1.25以降)    メニューの「設定」→「設定の初期化」→「各エンジン設定の初期化」

- Q) 秒読み3秒のときに3/3になる前に時間切れで負けになる。
  - A) 秒読み3秒のときは2.99秒まではセーフで、2.99秒は表示上は2/3です。
    この状態までが時間切れではないという解釈で、3/3になった時点(3.00秒)で時間切れになります。
    ※　製品版(V1.00)では、3.99秒までをセーフとしていたのですが、その後アップデート(V1.05以降)で2.99秒までをセーフであると修正しました。

- Q) 同じエンジンと対局するときに毎回「エンジン初期化中」と出るのは何故なのでしょうか？
  - A) 対局開始時に思考エンジンをバックグラウンドで起動して、対局終了時には思考エンジンを終了させています。(対局していない時にメモリを確保したままにしないために)
    ShogiGUIや将棋所でもこういう動作になっています。エンジンが1つ固定であれば、ずっと起動しておくことは出来なくはないのでしょうけども…(激指とかそうなっている？)
    「エンジン初期化中」の表示のところで時間がかかるのは、メモリがたくさん(16GB以上)あるPCだとHASHの確保(初期化)に時間が
    かかるのも理由にあるので、その場合はエンジンの詳細設定でHASHの自動割り当てをやめて固定で確保すると「エンジン初期化中」の時間が短くなります。
    - (V1.34以降) HASHの確保を開始するときに、検討ウインドウの読み筋のところに「Hash Clear begin = 16[MB]」のように表示するようにしました。
    このメッセージが表示されてから対局が始まるまでの時間が、このHASHの初期化に費やされている時間です。
    また、平均的なスペックのPCで初期化には2GBにつき1秒程度かかるようです。例) 8192[MB] = 8GBですと4秒程度かかります。

- Q) 対局開始時に「エンジンの動作のために、物理メモリが100MB足りません。空き物理メモリが足らないので思考エンジンの動作が不安定になる可能性があります」
  のようなメッセージが表示されますが、コンピューターの棋力に影響はありますか？
    - この記事の下の方にある「ハッシュメモリ管理について」をご覧ください。

- Q) 相手に振り飛車をさせたい。
  - A) 現状、戦型指定機能は備わっていません。
    - 将来的な機能として対応を考えています。
    - とりあえず、初手で飛車を振った局面から対局を開始するなどしていただければと…。

- Q) 対局終了時にフォルダが作成できないというエラー(例外)が出るのですが。
  - A) 棋譜の自動保存を行うときに指定されているフォルダが作成できないため(権限がない、容量がない)だと思います。
    - メニューの「ウインドウ」→「対局結果の保存設定」からフォルダを変更してみてください。

 - Q) 思考エンジン側が必敗になったときに自ら投了するようには出来ませんか？
  - A) エンジンの「詳細設定」のResignValueの値がそれです。3000ぐらいにすると必敗ぐらいの形勢で自ら投了するようになります。

 - Q) エンジンは、1手0.3秒で指すのように1秒未満の設定は出来ませんか？
  - A) 1手1秒設定にした上で、エンジンの「詳細設定」のNetworkDelay2のところを「700」にすれば、(1秒切れ負けなので、NetworkDelay2の値が適用され)0.7秒前に
    指すので、1手おおよそ0.3秒程度の思考にはなります。


## 各思考エンジンについて


- Q) 『将棋神やねうら王』に収録されている5つのソフトなかで最強のソフトはどれですか？
  - A) レーティング計測上は、Qhapaq2018が最強でしたが、人間が体感できるほどの棋力の違いはないと思われますので、
  それぞれのソフトの棋風の違いを堪能していただければと思います。


- Q) 各思考エンジンの強みを教えてください。
  - A) 思考エンジンの選択画面には以下のような説明があります。
    - やねうら王(2018) "プロの棋譜を一切利用せずに自己学習で身につけた異次元の大局観。従来の将棋の常識を覆す指し手が飛び出すかも？",
    - tanuki-(SDT5) "SDT5(第5回 将棋電王トーナメント)で絶対王者Ponanzaを下し堂々の優勝を果たした実力派。SDT5 出場名『平成将棋合戦ぽんぽこ』
    - tanuki-(2018) "WCSC28(第28回 世界コンピュータ将棋選手権)に出場した時からさらに強化されたtanuki-シリーズ最新作。ニューラルネットワークを用いた評価関数で、他のソフトとは毛並みの違う新時代のコンピュータ将棋。
    - Qhapaq(2018) "河童の愛称で知られるQhapaqの最新版。非公式なレーティング計測ながら2018年6月時点で堂々の一位の超強豪。"
    - 読み太(2018) "直感精読の個性派、読みの確かさに定評あり。毎回、大会で上位成績を残している常連組。"


- Q) コンピュータが強すぎる（自分がこの段級位に負けるはずがない）

  - A) 段位の基準は将棋倶楽部24の基準に準拠させてあります。将棋倶楽部24の初段は、町道場の三、四段ぐらいの棋力ですので、少しシビアな段位となっています。
  - 同じ段位設定であっても思考エンジンごとに多少、棋力に差があります。

  - 連続対局で9段同士を戦わせてみたところ次のような結果になりました。(uuunuuunさんからの情報)
    - 各組み合わせ100局ずつ。総当たり戦。レーティングは将棋倶楽部24相当。
    tanuki-2018-9dan: R3306 (+22/-14)
    Qhapaq2018-9dan: R3252 (+11/-15)
    Yomita2018-9dan: R3193 (+13/-17)
    Yaneuraou2018-9dan: R3150 (+0/-0)
    tanuki-sdt5-9dan: R3127 (+17/-19)

  -「十段」「十一段」「十二段」に関する各エンジンごとの棋力のばらつき。
    NodesLimit(探索局面数)で制限をかけて棋力を調整しているので、nps(1秒間の探索局面数)が高いソフトほど不利になる傾向はあります。
    計測したところ「十二段」では、tanuki-2018 が強く、やねうら王が 最も弱くなっています。(masaさんからの情報)
      - 定跡16手（256手で引き分け）
      tanuki-2018(十二段)
      vs. Qhapaq(十二段)　　    58-37-5　R 78.1
      vs. 読み太(十二段)　　　64-35-1　R104.8
      vs. tanuki-SDT5(十二段)　68-27-5　R160.5
      vs. やねうら王(十二段)　73-22-5　R208.4

  - (V1.23以降) 1級～10級を下方修正しました。
      - 新1級 = 従来の2級(将棋倶楽部24の2級相当) , 新2級 = 従来の4級(将棋倶楽部24の2級相当) , 新3級 = 従来の6級 , … とりなり、 新10級 は 従来の計算だと20級相当となります。

- Q) (V1.23以降) Ｓ七段～Ｓ15級とは何ですか？
  - A) コンピューター将棋の特徴でもある序盤は弱いのに終盤だけ強いということのないように、人間らしい弱さを追求しました。
    「初段」と「Ｓ初段」では、勝率上は互角ですが、後者は、序盤がそこそこ強く、終盤がそこそこ弱いという人間らしい特徴があります。
    その代わり、「Ｓ初段」は通常の「初段」より思考時間を6倍程度使います。コンピューターにとっては手加減するのも大変ということですね。


- Q) プロ棋士とどちらが強いのですか？

  - A) このソフトの「九段」は将棋倶楽部24のR3200相当(平均的なプロ棋士レベル)で、「九段」に設定しても平均的なPCでは即指し(1秒以内)です。
  - 一段上がると勝率は76%程度。(「八段」と「九段」が戦うと「九段」側の勝率は76%程度です。)
  - このソフトの「将棋神」の強さは、持ち時間とお使いのPCスペックに依存しますが、だいたい「十二段」～「十四段」相当だとお考えください。
  - V1.13以降では「九段」の上の段位、「十段」「十一段」「十二段」のプリセットを用意しました。「十二段」は将棋倶楽部24換算でR3800に相当。(人類未到達。人類の最高はR3312)
    また、「十二段」に設定しても、いまどきのデスクトップ機(Core i7 4コア)で即指し(1手1秒程度)の模様。

- Q) PCによってどれくらい棋力が変わりますか？
  - A) かなり低スペックのPCでも「九段」が即指しですし、コンピュータの棋力が少しぐらい変わっても人間ではその違いをなかなか体感できないとは思いますが、PCを買い替えたほうが良いかなどを判断するための材料として、以下に計算例を書いておきます。

- Q) CPUがCore i7-3770とCore i7-8700とでどれくらい棋力が変わりますか？
  - A) ベースクロックは、3.4GHz→3.2GHzなので6%ぐらい速度down。
  - Ivy Bridge(AVX2非対応)→Coffee Lake-S(AVX2対応)なので2割ぐらい速度upに相当。
  - Core数 4→6なので並列度1.5倍up。コンピュータ将棋では、並列度の平方根ぐらいの速度upとみなせる(もう少し良いという説もある)ので、2割ぐらいの速度up。
  - 6%down×2割up×2割up = 0.94×1.2×1.2 = 1.36倍。
  - 速度が2倍になると自己対局ではeloレーティングにおいてR200程度upなので、1.36倍ならlog2(1.36)×R200 ≒ R89up。
  - R89upは、勝率で言うと62.5%。(前者のCPUと後者のCPUで戦うと後者のCPUが62.5%ぐらい勝つという意味)


- Q) どの設定にしたら一番強くなりますか？
  - A) 棋力プリセットとして、『10級』～『九段』はその棋力になるようにわざと弱く調整してあります。
  - 強くしたければ、棋力プリセットとして『カスタム』か『将棋神』を選択してください。
  - 『将棋神』を選択すれば、最強(に近い)設定に自動的になります。
  - 『カスタム』にして、エンジンの「詳細設定」で細かく設定することも出来ますが、PCと将棋に詳しい人向けの機能という感じです。


## スレッド数の設定について


- Q) エンジン個別設定の「スレッド数」とは何ですか？
  - A) 最近のCPUには、複数のコア(core)が搭載されているので、思考エンジンはそれぞれのコアに思考を割当てて、並列的に探索しています。
  その並列に動作させる数のことです。

- Q) この値を増やすと強くなりますか？
  - A) 棋力プリセットとして「カスタム」を選んでいるとき、CPUコアの数までは増やすと強くなります。
    (自動的にそういう設定になっているので、通例、手動で変更する必要はありません)

- Q) 値を変更しても反映しないようですが？
  - A) 「自動スレッド」のチェックをオフにした時のみ「スレッド数」の値が反映します。

- Q) 値を下げるとCPU負荷(エンジン動作時のCPUの温度など)は、下がりますか？
  - A) 下がりますが弱くなります。

- Q) 私のPCのCPUのコアの数はどうすれば確認できますか？
  - A) メニューの「ヘルプ」→「システム情報」のところで
    > brand: Intel(R) Core(TM) m3-7Y30 CPU @ 1.00GHz
    のように表示されます。これがお使いのCPU名なので「Core m3-7Y30」などで検索すればそのスペックが記載されているサイトが出てきます。

- Q) 私のPCは4コアでHT(ハイパースレッディング)ありのようですが、4を設定すべきですか？
  - A) そのPCでは、デフォルトでは「スレッド数」はコア数である4が設定されます。
    しかし、HT有りならばその2倍である8を設定したほうがわずかに強くなるはずです。(それを超えた値にすると、普通、弱くなります)
  なぜこのときにデフォルトで8を設定するようになっていないかと言うと、CPU温度が上がりすぎるのでノートPCなど排熱が甘い機種では
  長時間検討させる時など発熱しすぎる可能性があるためです。排熱のしっかりしたPCであれば大丈夫だと思いますが、変更は自己責任でお願いします。


## 対局中の操作について


- 駒の移動元と移動先の2点をクリックするか、移動元から移動先へドラッグするかすると駒を移動させることが出来ます。

- Q) 駒をクリックした時点で駒がマウスカーソルに追随するように出来ませんか？
  - A) (Update1.26以降) メニューの「設定」→「表示設定」→「操作」のタブのところから変更できます。そちらをデフォルトとしました。

- Q) 駒をマウスドラッグで移動できるを禁止できませんか？
  - A) (Update1.26以降) メニューの「設定」→「表示設定」→「操作」のタブのところから変更できます。


## 棋譜ウインドウについて


- Q) 棋譜ウインドウの表示/非表示はどうすればできますか？
  - A) メニューの「ウインドウ」→「棋譜ウインドウ」→「非表示(再表示)」から出来ます。
    (V1.24以降) Ctrl+K を押すごとに表示/非表示が切り替わります。

- Q) 棋譜ウインドウの文字が小さくて読めないです。
  - A)
    1) メインウインドウに埋め込み時は、その横幅に収まるように文字フォントサイズを小さくするためです。
    メニュー→「ウインドウ」→「棋譜ウインドウ」→「メインウインドウに埋め込み時の横幅」を変更することで文字フォントサイズも同時に変わります。
    2) メインウインドウに埋め込んでいないときは、棋譜ウインドウの右下にある「+」「-」ボタンで文字フォントサイズを調整できます。
      メインウインドウから独立(フロート)させるためには、メニューの「ウインドウ」→「棋譜ウインドウ」→「表示位置」で調整できます。


## 検討モードの使い方


- Q) 検討モードはどうすれば開始できますか？
  - A) 対局中ではないときに、メニュー下のTooltip(ボタンの並び)にある「検」ボタン(検討ボタン)をクリックしてください。
  - 一度目は検討で用いる思考エンジンの選択画面になります。

- Q) 検討モードで用いる思考エンジンの選択画面を再度出すにはどうすれば良いですか？
  - A) メニューの「対局」→「検討エンジン設定」から出すことが出来ます。

- Q) 検討ウインドウの表示/非表示はどうすればできますか？
  - A) メニューの「ウインドウ」→「検討ウインドウ」→「非表示(再表示)」から出来ます。
    (V1.24以降) Ctrl+R を押すごとに表示/非表示が切り替わります。

- Q) 検討モードのときに盤面の駒を動かすことは出来ますか？
  - A) 対局時と同様に駒をマウスの操作で動かすことが出来ます。
    - このとき、合法手しか指せません。将棋のルールを無視して自由に駒を動かすには、盤面編集モードを使う必要があります。
    - また、棋譜ウィンドウ上の特定の指し手をマウスでクリックするか、カーソルキーで移動するかして、棋譜のその局面に移動すると自動的に
    思考エンジンがその局面に対する検討を開始します。

- Q) 検討モードを終了するには？
  - A) 「検」ボタンがあったところが「終」になっているはずです。このボタンを押すと終了します。
  
- Q) 検討モードのミニ盤面はどうやったら指し手が動きますか？
  - A) 読み筋のところをクリック(or カーソルキーなどで選択)すると、検討ウィンドウのミニ盤面にその局面と変化が反映されます。
  - そのあと、ミニ盤面の近くにある「◀」「▶」などで局面を進めたり戻したりできます。
  - ミニ盤面の棋譜の操作のショートカットキーは、Ctrl + 矢印キーです。これはメニューの「設定」→「操作設定」→「ミニ盤面」のところで変更できます。

- Q) 平手の開始局面など序盤で評価値が 0(ゼロ)が表示されることがある。
  - A) 定跡にヒットしたとき、その定跡データに書かれている評価値が表示されます。「標準定跡」の場合、0が書かれているので0が表示されます。

- Q) 検討モードのとき定跡を使いたくありません。
  - A) 通常対局用と検討用とで個別にエンジン設定を行うことが出来ます。
  　検討モードで一切定跡を使いたくないのであれば、検討用の「共通設定」のところで定跡をオフにしておけば良いでしょう。

- Q) "++/--"の列はどういう意味ですか？
  - A) その評価値がupperbound(≒上限値)、lowerbound(≒下限値)であることを示します。
      例えば、"++"と出ていて、評価値が1000と出ていれば、真の値(本当の評価値)は、それよりは低そうだと思考エンジンは見積もっているということを示しています。

- Q) 「深さ」のところに表示される「◯／◯」の数字の意味は？
　- A) 「深さ」というのは、「手数」に近い意味で、何手先まで局面を調べているかを意味します。
　　「◯／◯」の最初の数字は探索深さ（その手数の主力変化を読んでいる）で、2つ目の数字はそのなかの一番深いところの深さです。
    王手されている局面などでは、一手延長して読むので、そういう感じで一番深くまで到達した変化の手数です。
    
- Q) 読み筋に表示されることのある「優等局面」「劣等局面」とは何ですか？
  - A) 将棋で4手セットで、歩を無条件に相手に渡すことがあります。「23歩成、同玉、24歩、22玉」を繰り返すと先手のほうは手駒の歩が1つずつ相手の手駒に移動します。
    これは元の局面より絶対的に優れていると考えられるので、思考エンジンはここで読みを打ち切ります。
    このとき「(先手から見て)劣等局面に突入」したと言います。後手から見ると「優等局面に突入した」と言います。

- Q)「候補手５手」になっているのに平手の開始局面で5手以上表示されます。
  - A) 定跡にヒットした場合は、その内容をすべて表示します。これは仕様です。

- Q) 定跡にヒットしたときに読み筋の指し手のところに「(98.3%)」のような数字が書いてありますが、これは何ですか？
  - A) その定跡の出現率です。実戦譜のようなものから生成した定跡ファイルだと、出現頻度が記載してあるので、それを表示しています。

- Q) HASH使用率とは何ですか？
  - A) コンピューター将棋の用語として「HASH」とは、一度調べた局面の情報を保存しておくためのメモリのことを指します。置換表とも呼ばれます。
  このHASH用のメモリの使用率が表示されています。この数字が高く(50%ぐらい以上に)なってくると、一度調べた局面の情報を残しておけなくなってくるため、
  探索効率が悪くなり、本来の棋力(メモリが潤沢にある時の棋力)より低くなります。このように、HASH使用率は、メモリが不足しているかどうかの目安になります。

- Q) 検討ウインドウの表示高さ(表示量)を変更することは出来ますか？
  - A) (V1.22以降) メインウインドウへの埋込み時の高さは、メニューの「ウインドウ」→「検討ウインドウ」→「メインウインドウに埋め込み時の高さ」で変更できます。
    200%にしても高さが足りない(表示量をもっと増やしたい)場合は、メニューの「ウインドウ」→「検討ウインドウ」→「表示位置」で「メインウインドウに埋め込む」以外を選べば
    フロートさせられる(メインウインドウとは別ウインドウになり自由に移動できる)ので、そのあとに検討ウインドウの右端隅をドラッグするなどしてリサイズしてみてください。

- Q) 継ぎ盤(ミニ盤面)を大きくしたいのですが。
  - A) 検討ウィンドウのウインドウ自体の高さをマウスで(ウィンドウの隅をドラッグして)変更するとそれに追随して自動的に継ぎ盤も大きくなります。
    (V1.22以降)検討ウインドウをメインウインドウに埋め込んでいる時であれば、メニューの「ウインドウ」→「検討ウインドウ」→「メインウインドウに埋め込み時の高さ」で
      検討ウインドウの表示高さが調整できるので、それに応じて、継ぎ盤の大きさも変わるはずです。

- Q) 継ぎ盤(ミニ盤面)を検討ウインドウのようにフロートさせて自由にサイズを変更することは出来ますか？
  - A) (V1.36以降)メニューの「ウインドウ」→「ミニ盤面」のところからできます。

- Q) 検討ウインドウに表示されている読み筋をコピーしたり、本譜の棋譜に取り込んだりできますか？
  - A) (V1.37以降) 読み筋のところを右クリックしたときに表示されるメニューで以下の4つが選択できます。
    - メイン棋譜にこの読み筋を分岐棋譜として送る(&S)
    - メイン棋譜をこの読み筋で置き換える(&R)
    - 読み筋を表示のままの文字列でクリップボードに貼り付ける(&P)
    - 読み筋をKIF形式でクリップボードに貼り付ける(&K)

- Q) 『Apery』のようなUSI対応の外部の将棋エンジンを登録して対局や検討に使うことは出来ますか？
  - A) 現状、使えません。将来的には対応するつもりです。


## (検討ウインドウなどに表示される)評価値について


- Q) 評価値とは何ですか？
  - A) 思考エンジンが現在の局面の形勢をどのように評価しているかを数値化したものです。
    良いとプラス、悪いとマイナスの値になります。
    歩1枚の点数が100点を意味するように正規化されて表示されています。
    - 将棋では、手駒という概念があるので、歩1枚の駒得は、自分の手駒の歩(+100) + 相手の歩の欠損(+100) = +200の評価値として表現されます。
    - 詰みを見つけた時の値は大きな値になります。

- Q) 後手の評価値は手番側(後手)から見た評価値ですか？
  - A) デフォルトではそうなっています。(V1.33まで。V1.34以降は、後手側も先手から見た評価値をデフォルトと変更しました。)
  - これは、メニューの「設定」→「表示設定」→「評価値」→「後手番のCPUの評価値をどちらから見た値にするか」のところで変更できます。
  - 検討モードで使うときに、手番ごとに評価値の符号が反転するとわかりにくいので、後手側も先手から見た評価値にすることをお勧めします。

- Q) 手番側から見た評価値だと、形勢グラフに先手と後手と両方の評価値をプロットしたときに後手は符号を逆にしないとおかしくなりませんか？
  - A) はい、おかしくなります。このため、形勢グラフを見ることが前提にあるなら、後手番の評価値も先手側から見た値を表示されていないと紛らわしいように思います。

- Q) 評価値として「MATE(13手)」のように表示されましたが、これは即詰みですか？
  - A) 詰将棋エンジンではない通常の思考エンジンの場合、「MATE(13手)」は、「相手がどう応じても最大でも13手で勝ち」の意味です。
    最善を尽くせばもっと短手数かも知れませんし、途中に王手ではない自分の指し手が含まれるかも知れません。

- Q) 評価値に「31111」と表示されることがありますが、これは何か特別な値ですか？
  - A) このへんは思考エンジンごとに異なるのですが、『将棋神やねうら王』に収録されているエンジンの場合ですと、この値は優等局面の値となっています。
    (優等局面については、検討モードの使いかたのところにその説明があります。)
  - 開発者向け補足 : VALUE_SUPERIOR(優等局面のスコア) == 28000 , PawnValue == 90、USIプロトコルでは Scoreの単位がcenti-pawnなので、これが100になるように100/90倍して出力するので 31111。


## 詰将棋モードの使い方


- Q) 詰検討はどうすれば開始できますか？
  - A) 対局中ではないときに、メニューのTooltipにある「詰」ボタン(詰検討ボタン)をクリックしてください。

- Q) 詰検討モードで用いる思考エンジンの選択画面を再度出すにはどうすれば良いですか？
  - A) メニューの「対局」→「詰検討エンジン設定」から出すことが出来ます。

- Q) 詰検討モードを終了するには？
  - A) 「詰」ボタンがあったところが「終」になっているはずです。このボタンを押すと終了します。

- Q) 詰検討モードのときに盤面の駒を動かすことは出来ますか？
  - A) 検討モード同様、駒のマウス操作、棋譜ウィンドウの操作を行うことが出来ます。

- Q) 詰め手順を最後まで知りたいときは？
  - A) 検討モード同様、読み筋のところで右クリックをすればメニューとして以下のものが出てきます。
    - メイン棋譜にこの読み筋を分岐棋譜として送る(&S)
    - メイン棋譜をこの読み筋で置き換える(&R)
    - 読み筋を表示のままの文字列でクリップボードに貼り付ける(&P)
    - 読み筋をKIF形式でクリップボードに貼り付ける(&K)

- Q) 解けない詰将棋があります。
  - A) メモリが不足してくると一度調べた局面の情報を保存しておけなくなるため、解けるはずの問題も解けなくなることがあります。
  (V1.17以降)メモリの使用率は、「HASH使用率」のところに表示され、定期的に更新されます。
  この数字が高くなってくると(50%ぐらいを超えると)、解けなくなる可能性が高くなってきます。

- Q) 詰手順が詰将棋的に見ておかしいです。
  - A) tanuki-詰将棋エンジンは、長手数の実戦的な詰将棋をなるべく短時間で解くことに主眼がおかれて開発されたものなので、詰将棋の(創作方面の)検討には向いていない意味があります。

- Q) 余詰め検討は出来ませんか？
  - A) 上の回答と重複しますが、詰将棋の(創作方面の)検討には向いていない意味があります。
  詰将棋の(創作方面の)検討に向いた詰将棋エンジンも今後開発していくつもりです。

- Q) 『脊尾詰』のようなUSI対応の外部の詰将棋エンジンを登録して使うことは出来ますか？
  - A) 現状、使えません。将来的には対応するつもりです。


## 盤面編集


- Q) 盤面編集はどうすれば出来ますか？
  - A) 対局中ではないときに、メニューの「盤面編集」→「盤面編集の開始」のところから行えます。

- Q) 盤面編集で成り駒を作るには？
  - A) 駒の上でマウスの右クリックをすると先手の駒→先手の成り駒→後手の駒→後手の成り駒という順番で変化します。

- Q) 盤面編集で、相手の駒を取ると取れずに自分の駒と入れ替わってしまします。
  - A) 将棋所やShogiGUIでは、手駒に移動しますが、本ソフトでは「マウスで駒の移動元と移動先に駒がある場合はその2駒を入れ替える」ようになっています。
  - 例えば、将棋所方式だと、駒を移動させて玉の上に持ってくることが出来ません。(玉が手駒に移動させられないため)
  - なので、本ソフトの仕様のほうが、慣れれば便利かと思っていますが、この仕様が不評でしたら、将棋所やShogiGUIのような仕様に将来的に変更するかも知れません。


## 表示設定について


- Q) 表示設定をすべて初期状態に戻すことはできますか？
  - A) (V1.25以降)    メニューの「設定」→「設定の初期化」→「各表示設定などの初期化」


## 棋譜の自動保存について


- Q) 対局結果はどこで確認できますか？
  - A) メニューの「ウインドウ」→「対局結果一覧」から確認できます。
    - (V1.36以降)メニューの「対局」配下に移動しました。

- Q) 棋譜の自動保存をしないようにするにはどうすれば良いですか？
  - A) メニューの「ウインドウ」→「対局結果の保存設定」から設定できます。
    - (V1.36以降)メニューの「対局」配下に移動しました。

- Q) 棋譜が保存されないです。
  - A) メニューの「ウインドウ」→「対局結果の保存設定」を確認してください。
    - (V1.36以降)メニューの「対局」配下に移動しました。
    保存する設定になっているとして、メニューの「ウインドウ」→「対局結果一覧」を選んで、対局結果の行をどれか選んで、
    「棋譜保存フォルダを開く」をクリックするとその棋譜が保存されているフォルダが(その棋譜ファイルが選択されている状態で)開きますのでそれで確認してみてください。


## 連続対局について


- Q) 連続対局のときに画面上に表示される「6-0-4 (60.0% R70.4)」のような数字はどういう意味ですか？
  - A) 「6-0-4」は先手勝ち局数 = 6、後手勝ちの局数 = 4、引き分けの局数 = 0という意味です。
    「60.0%」は先手から見た勝率。「R70.4」は、先手が後手よりどれだけR(レーティング)が高いかです。

- Q) 連続対局の対局数100、先手勝ち50、後手勝ち50のような対局結果を確認する手段はありますか？
  - A) メニューの「ウインドウ」→「対局結果一覧」の対局日時の列に出力されています。(列の幅が狭くて、デフォルトでは表示が隠れていますが…)
    47-3-50なら、47勝、50敗、3引分の意味です。

- Q) レーティングとは何ですか？
  - A) チェスでよく使われている強さの指標です。本ソフトではElo ratingを採用しています。

- Q) 連続対局の結果はどこで確認できますか？
  - A) メニューの「ウインドウ」→「対局結果一覧」から確認できます。

- Q) 対局結果一覧に出てくる情報はどこに書き出されていますか？
  - A) メニューの「ウインドウ」→「対局結果の保存設定」で設定したフォルダの"game_result.csv"というファイルに書き出されています。
  - このファイルを最新版のExcel(Excel 2016)で開けることは確認しています。
  - 文字のエンコードがutf-8のCSVファイルなので古いExcelで文字化けするときは、

- Q) 「十二段」で特定の局面から連続対局をさせると何度やっても同じ棋譜(同じ進行)になります。
  - A) 棋力が高くなってくると指し手のばらつきが減るので(神の指し手に近づいていくから？)、あまり変化のない局面からだと同じエンジンである以上、同じ進行になりやすいです。
  - 複数エンジンでの対局が自動化出来る、蠱毒という機能(≒リーグ戦機能)を将来的につける予定です。そちらならば、棋譜がある程度バラけると思います。
  
- Q) 特定の局面から連続対局させた棋譜を一つの棋譜にマージする機能はありますか？
  - A) 棋譜のマージ機能は、将来的につけようとは思っています。連続対局のときにフォルダを作成してそこに棋譜を書き出すのはそのための布石です。


## 棋譜の入出力


- 棋譜をファイルから読み込むには、メニューの「ファイル」→「棋譜を開く」を選びます。
- 棋譜をファイルに書き出すには、メニューの「ファイル」→「棋譜に名前をつけて保存」 を選びます。
 
- 対応している棋譜/局面のフォーマット KIF,KI2,CSA,SFEN,PSN,PSN2形式
  - 棋譜を読み込む時は、どのフォーマットであるか自動判定します。
  - 書き出し時は、上記のどの形式で書き出すのかを選択する必要があります。

- Q) 棋譜形式がたくさんありすぎてよくわかりません。
  - A) 普通に使うときはKIF形式で保存しておくと良いと思います。この形式は、他の将棋ソフトでも広く対応しています。
  - 局面図を画像として出力したいときはSVG形式で保存します。
  - それ以外は、マニア向けの棋譜形式だとお考えください。

- Q) 局面図を将棋の書籍にある局面図のような白黒画像で出力したいのですが。
  - A) 画像で出力する機能はありませんが、SVG形式でファイルに出力する機能はあります。
    メニュー「ファイル」→「局面の保存」でSVG形式を選択すれば、SVG形式でファイルに書き出すことが出来ます。
    このファイルは、Chrome , IE , Microsoft Edgeなどのブラウザで開くことが出来ます。ブラウザによって微妙に見え方が異なります。Chromeをお勧めします。
  
- Q) KIF形式で書き出したファイルが柿木将棋IXで読み込めません。
  - A) 本ソフトは、棋譜の文字のエンコードをutf-8で書き出すためです。(柿木将棋がUnicodeのファイルに対応していないためです。)
    - Kifu for Windows V7 , 将棋所 , ShogiGUIでは問題なく読み込めるようです。
    - 参考記事 : [『将棋神やねうら王』で書き出したKIFファイルが『柿木将棋』で読み込めない件](http://yaneuraou.yaneu.com/2018/08/31/%E3%80%8E%E5%B0%86%E6%A3%8B%E7%A5%9E%E3%82%84%E3%81%AD%E3%81%86%E3%82%89%E7%8E%8B%E3%80%8F%E3%81%A7%E6%9B%B8%E3%81%8D%E5%87%BA%E3%81%97%E3%81%9Fkif%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%81%8C/)
    - 解決策1) 本ソフトで保存したファイルをテキストエディタで開いてsjisで保存しなおすと読み込めるようになります。
    - 解決策2) 本ソフトのメニューの「ファイル」→「クリップボードに棋譜/局面をコピー」(V1.13以降、Ctrl+Vで可)でKIF形式を選び、柿木将棋にCtrl+Vで貼り付ければ読み込めます。
    - 解決策3) 『Kifu for Windows V7』で一度読み込み、KIF形式で保存しなおす。

- Q) 文字のエンコード、sjis(Shift_JIS)で書き出す機能はありませんか？
  - A) 対局者名にsjisで表現出来ない文字を使うことがありますし、sjis形式のkifファイルは将来的になくなっていくと考えられるのであえてつけていないです。

- Q) マイナビ出版の将棋情報局の棋譜ファイルを『将棋神やねうら王』で読み込むことは出来ますか？
  - A) 次の一手問題集、戦術書、実戦集の書籍の特典棋譜ファイルについて確認しましたが、すべて問題なく、『将棋神やねうら王』で読み込めました。
  ただ、棋譜ファイルには棋譜コメントとして「第１図」のようなコメントが入っています。棋譜コメントは現状、表示する機能がないです。(今後のUpdateで追加)

- Q) 対局が終わって、棋譜ファイルを開くと、主画面(対局画面)から、「レベル」と「駒落ち設定」の部分の表示が消えています。
  - A) 棋譜ファイル(KIF形式)に、その情報を保存しておくところがなくて、どうしようかと決めかねています。KIF形式を下手に拡張すると他のソフトで読み込めなくなるので、なかなか難しいです。考えておきます。


## エンジンの「詳細設定」について


- 対局設定ダイアログの「詳細設定」のボタンを押すと「エンジンオプション設定」というダイアログが表示されます。
  このダイアログでエンジンの詳細な設定を行うことが出来ます。
  これは、細かい調整までしたい人向けの設定であり、普通は、ここで調整せずとも自動的に最適に近い設定になっています。

- Q) それぞれのオプションの意味がよくわかりません。
  - A) マウスカーソルを項目名のところにホバーさせると説明が出ます。
  試しに「ハッシュメモリ管理」「自動ハッシュ」などのところにマウスカーソルをホバーさせてみてください。

- Q) この設定ダイアログの上にある「共通設定」と「詳細設定」との違いがよくわかりません。
  - A) 「共通設定」はすべてのエンジンに同じ設定を適用したい場合に用います。
    「詳細設定」は特定のエンジンだけ設定を変更したい場合に用います。

- Q) 「詳細設定」 の各項目の左端にあるチェックボックスは何ですか？
  - A) このチェックボックスにチェックが入っているときは、この項目の設定は、「共通設定」のほうに従うという意味です。
  デフォルトではチェックが入っているので共通設定に従っています。なので、このエンジンだけ特定の項目を個別に設定したいときは、
  まずこの左端のチェックボックスのチェックを外す必要があります。

- Q) 「自動ハッシュ」のチェックを外すと対局開始時に物理メモリが足りないと表示されます。メモリを増設したほうが良いのでしょうか？
  - A) この部分、わかりにくくてすみません。まずは「ハッシュメモリ管理」と「自動ハッシュ」の項目名のところにマウスカーソルをホバーさせてそれぞれの説明を読んでみてください。
  　また、詳しい仕組みについては、この下にある「ハッシュメモリ管理について」をご覧ください。

- Q) (V1.21以降)「詳細設定」にあるSkillLevelとはどうやって棋力を弱くするためのものですか？設定すべき値がわかりません。
  - A) このオプションに関して詳しい解説はこちらの記事にあります。→ [やねうら王のSkillLevelオプションとは何ですか？](http://yaneuraou.yaneu.com/2018/09/24/%E3%82%84%E3%81%AD%E3%81%86%E3%82%89%E7%8E%8B%E3%81%AEskilllevel%E3%82%AA%E3%83%97%E3%82%B7%E3%83%A7%E3%83%B3%E3%81%A8%E3%81%AF%E4%BD%95%E3%81%A7%E3%81%99%E3%81%8B%EF%BC%9F/)


## ハッシュメモリ管理について


- ここではハッシュメモリ管理について詳しく説明します。
- 基本的には自動的に最適に近い値に設定されるのでここまで詳しく知る必要はないので、興味のない方は読み飛ばしていただいて問題ないです。


- Q) 「ハッシュメモリ」とは何ですか？
  A) エンジンは、調べた局面の情報を保存しておくのに置換表という表に記憶しています。これをコンピューター将棋界隈では「ハッシュ(HASH)」と呼びます。
  　これが最低限の容量すら確保できない場合は、エンジンは動作できません。
  　また、このメモリが十分に確保できない場合は、十分に確保できる場合に比べるとコンピューターの棋力が多少下がります。

- Q) 対局開始時に「エンジンの動作のために、物理メモリが100MB足りません。空き物理メモリが足らないので思考エンジンの動作が不安定になる可能性があります」
  のようなメッセージが表示されますが、コンピューターの棋力に影響はありますか？
  - A) メモリが足りないと思考エンジンが使うメモリが確保できなくて、そもそも動作しない場合があります。
  100MB程度でしたら、OSが他のプログラムを退避させるなり何なりして空けてくれるので普通は正常に動くとは思いますけども。
  あと一度調べた局面の情報を保存しておくためのハッシュを最低限しか確保できないので、メモリが潤沢にある環境に
  比べると多少棋力が下がります。(人間が感知できるほどではないと思いますが)

- Q) 対局開始時に物理メモリが足りないというメッセージが表示される場合、メモリを増設したほうが良いのでしょうか？
  - A) PCに搭載されているメモリが2GB　→　エンジンによっては本当に足りない。
       PCに搭載されているメモリが4GB  →　足りないと表示されてもOS(Windows)が物理メモリを確保してくれることが多いが、異なる2つのエンジンを対局させる場合本当に足りないことも。
       PCに搭載されているメモリが8GB  →  基本的には足りているはずなので普通はメモリ増設の必要はありません。

- Q) エンジンの「詳細設定」にある「自動ハッシュ」のチェックボックスのチェックを外すと、対局開始時に物理メモリが足りないと表示されます。メモリを増設したほうが良いのでしょうか？
  - A) この部分、わかりにくくてすみません。まずは「ハッシュメモリ管理」と「自動ハッシュ」の項目名のところにマウスカーソルをホバーさせてそれぞれの説明を読んでみてください。

- Q) エンジンの「詳細設定」のハッシュメモリ管理のところで自分でハッシュメモリを手動で割り当てたいので詳しい仕組みについて教えてください。
  - A)
    1.「自動ハッシュ」のチェックボックスにチェックが入っている場合。
    このとき、その下にある「Hash割合」の数値の分だけ空き物理メモリからHASH用に確保します。
    いま仮に空き物理メモリが 2000MBあるとしましょう。
    2000MBから、エンジンが使う最低限のメモリをまず確保します。
    これは、エンジンにより異なります。tanuki-2018年度版が一番少なく500MB程度となっています。tanuki-2018年度版の場合で考えてみましょう。
    すると2000MB - 500MB = 1500MBの空き物理メモリがあることになります。ここからハッシュ用のメモリを70%確保するので、1500MB×70% = 1050MBを確保します。
    残りの空き物理メモリは450MBです。この空き物理メモリでGUI本体が動作するという仕組みです。なので、この70%という数字を大きくするとGUI本体が動作できなくなります。

    2.「自動ハッシュ」のチェックボックスにチェックが入っていない場合。
    このとき、その2つ下にある「Hash[MB]」と書かれたところの数字の分だけ固定でハッシュ用のメモリを確保します。
    デフォルトでは「4096」と書かれているはずです。ですので、ハッシュ用に4096MB確保することになります。
    上の例ですと1500MBの空き物理メモリからハッシュ用に割り当てないといけないので1500MB - 4500MB = -3000MB となり、足りていません。
    このため、対局開始時に空き物理メモリが3000MB足りない旨のメッセージが表示されることになります。
    つまり、このとき、この「4096」のところはもう少し減らしてやる必要があります。

- Q) 「MB」という単位がよくわかりません。私のPCは8GBあるはずなのですがこれでは「Hash[MB]」のところを「4096MB」にすると足りないのでしょうか？
  - A) 1GB = 1024MBです。ゆえに8GB = 8192MBです。一見、ここからなら4096MBを確保できそうに見えますが、実際にはOSが1GB(1024MB)～2GB(2048MB)程度消費していますし、他に常駐プログラムなどが多ければそれらも物理メモリを圧迫しています。
  　また、思考エンジン自体の動作にはハッシュ以外にもメモリが必要です。例えば、読み太、Qhapaq、tanuki-(SDT5)はこれが1GB(1024MB)程度必要です。
    異なる二種類のエンジンを対局させるなら、それぞれハッシュメモリが必要です。
    例として、読み太 vs Qhapaqを対局させるならば、搭載メモリ8GBで、OSが2GB消費しているとして、各エンジンが(HASHを除いて)1GBずつ使うので、残り4GBしかないことになります。
    この4GBのうちGUI側が0.5GBほど使うので、それぞれのエンジンのハッシュに割り当てられるのは、最大で3.5GB / 2 = 1.75GB(1792MB)となります。
    つまり、メモリを8GB搭載しているPCで、(エンジンオプション設定の「自動ハッシュ」のチェックボックスのチェックを外して)「Hash[MB]」に「4096」を指定すると、メモリが確保できないことになります。
    ゆえにこのとき、対局開始時に物理メモリが確保できないと表示されます。

- Q) HASHの仕組みについて詳しく知りたいです。
  - A) (やや専門的になりますが)以下の記事に詳しいです。
    【決定版】コンピュータ将棋のHASHの概念について詳しく : http://yaneuraou.yaneu.com/2018/11/18/%E3%80%90%E6%B1%BA%E5%AE%9A%E7%89%88%E3%80%91%E3%82%B3%E3%83%B3%E3%83%94%E3%83%A5%E3%83%BC%E3%82%BF%E5%B0%86%E6%A3%8B%E3%81%AEhash%E3%81%AE%E6%A6%82%E5%BF%B5%E3%81%AB%E3%81%A4%E3%81%84%E3%81%A6/


## 定跡について


- Q) 定跡の編集機能はありますか？
  - A) 現状ありません。将来的につけるかも知れません。近年は、定跡ファイルはコンピューターで自動生成するのが主流なので、時代に逆行している気がして用意していません。
    コンピューター側の戦型選択のために定跡を編集したいという動機はわかりますが、戦型選択機能自体は別途実装する予定です。

- Q) 定跡のフォーマットについて教えていただけますか？
  - A) やねうら王の標準定跡ファイルフォーマットを用いています。
    cf. 将棋ソフト用の標準定跡ファイルフォーマットの提案 : http://yaneuraou.yaneu.com/2016/02/05/%E5%B0%86%E6%A3%8B%E3%82%BD%E3%83%95%E3%83%88%E7%94%A8%E3%81%AE%E6%A8%99%E6%BA%96%E5%AE%9A%E8%B7%A1%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%83%95%E3%82%A9%E3%83%BC%E3%83%9E%E3%83%83%E3%83%88%E3%81%AE/

- Q) Aperyの定跡ファイルは読み込めますか？
  - A) (V1.23以降) エンジンの詳細設定で定跡として「Aperyの定跡ファイル」を選択し、
    book.binというファイル名のファイルをMyShogi.exe配下のbookフォルダに配置すると読み込めるようになっています。


## デバッグ機能について


- Q) メニューの「ウインドウ」→「デバッグ用のログ」とは？
  - A) 思考エンジンとやりとりしている内容を確認できます。興味のある方は、[開発者向け機能](dev_manual.md)をご覧ください。


## コマンドラインからのコマンドについて


- Q)『棋譜の管理』という棋譜データベースからこのソフトを起動したいのですが、起動時にコマンドラインから棋譜ファイルを指定することは出来ますか？
  - A) MyShogi.exe -f [ファイル名] のようにすると、その棋譜ファイルを起動時に開くことが出来ます。(V1.13以降)
  - A) MyShogi.exe [ファイル名]のように指定しても良いことにしました。(V1.16以降)
  

## 便利な機能(tips)


- 棋譜ファイルをメインウインドウにドラッグ＆ドロップするとその棋譜が読み込めます。
- メインウィンドウがアクティブな時にCtrl+Cで現在の棋譜をKIF形式でクリップボードにコピーすることが出来ます。
- メインウインドウがアクティブな時にCtrl+Vで棋譜テキストをクリップボードからペーストする(読み込むこと)が出来ます。
- Ctrl+K (棋譜のK) で棋譜ウインドウの表示/非表示が切り替えられます。
- Ctrl+R (検討 = ConsiderationのR) で検討ウインドウの表示/非表示が切り替えられます。


## おまけ


- 読み上げ用のwavファイルを置き換えてカスタマイズしたい人向けに、インストール先の sound/takemata/ フォルダに
  竹俣先生台本.xlsx という読み上げ用の台本(Excelのファイル)が入れてあり、wavファイルの内訳が一目瞭然。

